(sqllm) zhaojiam@jfnb-spr-100477:~/SqueezeLLM$ python llama.py models/llama-2-7b c4 --wbits 3 --load sq-llama-2-7b-w3-s0.pt --benchmark 128 --check --torch_profile
No CUDA runtime is found, using CUDA_HOME='/rdrive/ref/cuda/lin/cuda-12.4'
2.1.0.post2+cxx11.abi
2.1.30.post0
[0]: _DeviceProperties(name='Intel(R) Data Center GPU Max 1100', platform_name='Intel(R) Level-Zero', dev_type='gpu', driver_version='1.3.29138', has_fp64=1, total_memory=49152MB, max_compute_units=448, gpu_eu_count=448)
models/llama-2-7b
Loading model ...
Done.
2024-06-25 03:58:13,424 - datasets - INFO - PyTorch version 2.1.0.post2+cxx11.abi available.
STAGE:2024-06-25 03:58:39 1031346:1031346 XPUActivityProfilerController.cpp:271] Completed Stage: Warm Up
Model type : llama
Benchmarking ...
0 0.39501333236694336
1 0.03267025947570801
2 0.02868509292602539
3 0.029025793075561523
4 0.029210329055786133
5 0.03060746192932129
6 0.028597354888916016
7 0.028444290161132812
8 0.028483152389526367
9 0.04739212989807129
10 0.028641939163208008
11 0.02823042869567871
12 0.02848339080810547
13 0.02858567237854004
14 0.028282880783081055
15 0.028739452362060547
16 0.02846050262451172
17 0.028089284896850586
18 0.028374433517456055
19 0.028119564056396484
20 0.02851390838623047
21 0.028553485870361328
22 0.02790355682373047
23 0.027884244918823242
24 0.028306007385253906
25 0.028690338134765625
26 0.028180360794067383
27 0.02792811393737793
28 0.027764320373535156
29 0.028231382369995117
30 0.028032302856445312
31 0.028201580047607422
32 0.02902960777282715
33 0.02834796905517578
34 0.027865171432495117
35 0.027946949005126953
36 0.027991294860839844
37 0.0281064510345459
38 0.028011798858642578
39 0.02796196937561035
40 0.027928829193115234
41 0.028184890747070312
42 0.03024601936340332
43 0.02829909324645996
44 0.028043031692504883
45 0.02799844741821289
46 0.0282590389251709
47 0.02826976776123047
48 0.027959346771240234
49 0.02797222137451172
50 0.02798604965209961
51 0.028347492218017578
52 0.0287630558013916
53 0.028084278106689453
54 0.02803802490234375
55 0.028340816497802734
56 0.027930021286010742
57 0.028819561004638672
58 0.028037309646606445
59 0.02797985076904297
60 0.028352022171020508
61 0.02787041664123535
62 0.02894449234008789
63 0.029005765914916992
64 0.02839493751525879
65 0.027988195419311523
66 0.02794170379638672
67 0.027990102767944336
68 0.02800726890563965
69 0.03040623664855957
70 0.02836012840270996
71 0.027891159057617188
72 0.027950286865234375
73 0.028163433074951172
74 0.02789759635925293
75 0.027849435806274414
76 0.029720783233642578
77 0.028298377990722656
78 0.028246164321899414
79 0.027823686599731445
80 0.02776479721069336
81 0.027975797653198242
82 0.028339862823486328
83 0.029599428176879883
84 0.028362751007080078
85 0.02789306640625
86 0.02794504165649414
87 0.028218746185302734
88 0.027759552001953125
89 0.027832984924316406
90 0.027852535247802734
91 0.028183937072753906
92 0.029499292373657227
93 0.028078556060791016
94 0.027768373489379883
95 0.02769947052001953
96 0.028058767318725586
97 0.027676820755004883
98 0.027710437774658203
99 0.027768850326538086
100 0.028016328811645508
101 0.029499053955078125
102 0.027942895889282227
103 0.02796316146850586
104 0.02792644500732422
105 0.028104782104492188
106 0.027750253677368164
107 0.027794361114501953
108 0.027794837951660156
109 0.028162240982055664
110 0.029608964920043945
111 0.02806854248046875
112 0.0282442569732666
113 0.028354167938232422
114 0.027817964553833008
115 0.02783799171447754
116 0.02778339385986328
117 0.02771449089050293
118 0.028090953826904297
119 0.027814865112304688
120 0.02841925621032715
121 0.02906513214111328
122 0.028769969940185547
123 0.02784132957458496
124 0.027738332748413086
125 0.02828502655029297
126 0.028451919555664062
127 0.03191661834716797
Median: 0.02811300754547119
PPL: 7164.03173828125
max memory(MiB): 0
STAGE:2024-06-25 03:58:43 1031346:1031346 XPUActivityProfilerController.cpp:278] Completed Stage: Collection
STAGE:2024-06-25 03:58:43 1031346:1031346 XPUActivityProfilerController.cpp:281] Completed Stage: Post Processing
--------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------
                                  Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg    # of Calls
--------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------
                     clGetPlatformInfo         0.04%      16.000us         0.04%      16.000us       0.129us           124
                        clGetDeviceIDs         0.02%       7.000us         0.02%       7.000us       0.156us            45
                       clGetDeviceInfo         0.05%      19.000us         0.05%      19.000us       0.065us           291
                        clRetainDevice         0.00%       0.000us         0.00%       0.000us       0.000us            26
                       clReleaseDevice         0.00%       0.000us         0.00%       0.000us       0.000us            37
                       clCreateContext        97.76%      35.751ms        97.76%      35.751ms       4.469ms             8
    clCreateCommandQueueWithProperties         0.17%      63.000us         0.17%      63.000us      12.600us             5
                      clGetContextInfo         0.00%       0.000us         0.00%       0.000us       0.000us            10
             clCreateProgramWithSource         0.01%       4.000us         0.01%       4.000us       4.000us             1
                        clBuildProgram         0.45%     164.000us         0.45%     164.000us      54.667us             3
                      clGetProgramInfo         0.00%       0.000us         0.00%       0.000us       0.000us             4
                      clReleaseProgram         0.04%      16.000us         0.04%      16.000us       5.333us             3
             clCreateProgramWithBinary         0.01%       4.000us         0.01%       4.000us       2.000us             2
                        clCreateKernel         0.01%       4.000us         0.01%       4.000us       4.000us             1
                       clGetKernelInfo         0.00%       0.000us         0.00%       0.000us       0.000us             1
                    clGetKernelArgInfo         0.01%       5.000us         0.01%       5.000us       0.625us             8
                        clRetainKernel         0.00%       0.000us         0.00%       0.000us       0.000us             1
                       clReleaseKernel         0.01%       3.000us         0.01%       3.000us       1.500us             2
                      clReleaseContext         0.05%      20.000us         0.05%      20.000us       2.000us            10
                 clReleaseCommandQueue         1.35%     493.000us         1.35%     493.000us     493.000us             1
                    clCreateSubDevices         0.00%       0.000us         0.00%       0.000us       0.000us             1
                       clRetainContext         0.00%       0.000us         0.00%       0.000us       0.000us             4
--------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 36.569ms

